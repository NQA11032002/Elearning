{"ast":null,"code":"import axios from \"axios\";\nimport { ref } from \"vue\";\nimport { useRoute } from 'vue-router';\nimport { findApiByName } from \"../../../assets/js/apiUtil.js\";\nexport default {\n  mounted() {\n    const isRegistered = async () => {\n      try {\n        //get url API\n        const apiObject = findApiByName(\"order\", \"course\").url;\n        const res = await axios.get(apiObject, {\n          params: {\n            courseID: parseInt(this.$route.params.id),\n            userID: parseInt(localStorage.getItem(\"idUser\"))\n          }\n        });\n        this.isRegistered = res.data;\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    isRegistered();\n  },\n  setup() {\n    const course = ref();\n    const route = useRoute();\n    const courseId = route.params.id;\n    const getCourse = async () => {\n      try {\n        const res = await axios.get(\"http://localhost:8087/api/course/\" + courseId);\n        course.value = res.data.data;\n        if (course.value.courseImages.length > 0) {\n          course.value.urlImage = course.value.courseImages[0].urlImage;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    getCourse();\n    return {\n      getCourse,\n      course\n    };\n  },\n  methods: {\n    formatPrice(price) {\n      return price.toLocaleString(\"vi-VN\");\n    },\n    //insert evaluation\n    async insertEvaluation() {\n      try {\n        const res = await axios.post(\"http://localhost:8087/api/evaluation\", this.formData);\n        if (res.status == 200) {\n          this.getCourse();\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    //submit form evaluation\n    submitFormEvaluation() {\n      const inputElement = this.$refs.evaluationInput;\n      if (inputElement) {\n        this.formData.courseID = inputElement.id;\n        this.insertEvaluation();\n      }\n    },\n    //change more or less evaluate\n    changeShowEvaluate() {\n      this.showMoreEvaluate = !this.showMoreEvaluate;\n      if (this.showMoreEvaluate == false) {\n        this.itemsPerPage = 5;\n      } else {\n        this.itemsPerPage = this.course.courseEvaluations.length;\n      }\n    },\n    //click subImage in page detail change main Image\n    changeImage(newImageUrl) {\n      this.course.urlImage = newImageUrl;\n    }\n  },\n  computed: {\n    displayedEvaluations() {\n      const start = (this.currentPage - 1) * this.itemsPerPage;\n      const end = start + this.itemsPerPage;\n      return this.course.courseEvaluations.slice(start, end);\n    },\n    pages() {\n      return Math.ceil(this.course.courseEvaluations.length / this.itemsPerPage);\n    }\n  },\n  data() {\n    return {\n      isRegistered: true,\n      formData: {\n        courseID: this.$route.params.id,\n        comment: '',\n        rate: 1,\n        userID: localStorage.getItem('idUser') != null ? localStorage.getItem('idUser') : null\n      },\n      showMoreEvaluate: false,\n      currentPage: 1,\n      itemsPerPage: 5\n    };\n  },\n  watch: {},\n  name: \"DetailCourse\",\n  components: {}\n};","map":{"version":3,"names":["axios","ref","useRoute","findApiByName","mounted","isRegistered","apiObject","url","res","get","params","courseID","parseInt","$route","id","userID","localStorage","getItem","data","error","console","log","setup","course","route","courseId","getCourse","value","courseImages","length","urlImage","methods","formatPrice","price","toLocaleString","insertEvaluation","post","formData","status","submitFormEvaluation","inputElement","$refs","evaluationInput","changeShowEvaluate","showMoreEvaluate","itemsPerPage","courseEvaluations","changeImage","newImageUrl","computed","displayedEvaluations","start","currentPage","end","slice","pages","Math","ceil","comment","rate","watch","name","components"],"sources":["C:\\Vuejs\\Elearning\\src\\components\\client\\courses\\DetailCourseScreen.vue"],"sourcesContent":["<template>\r\n  <div v-if=\"course\" class=\"max-w-screen-lg m-auto px-3 my-10 flex flex-col gap-7\">\r\n    <div class=\"w-full\">\r\n      <div class=\"rounded-lg flex flex-col gap-3\">\r\n        <div class=\"w-detail\">\r\n          <h1 class=\"text-gray-700 font-semibold text-xl\">{{ course.title }}</h1>\r\n\r\n          <div class=\"flex justify-between gap-3 mt-2\">\r\n            <p class=\"text-gray-400\">\r\n              <i class=\"fa-regular fa-clock\"></i>{{ course.createdAt }}\r\n            </p>\r\n            <p class=\"text-gray-400\">\r\n              Tác giả: <label for=\"\" class=\"font-semibold text-black\">EvonDev</label>\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"w-full flex justify-between gap-10\">\r\n          <div class=\"flex flex-col w-2/3 gap-2 bg-white rounded-xl shadow-md overflow-hidden\">\r\n            <img class=\"object-cover h-80 flex-shrink-0\" :src=\"course.urlImage\" alt=\"\" />\r\n            <div class=\"flex pb-2 justify-left mt-auto flex-1 cursor-pointer\">\r\n              <img @click=\"changeImage(image.urlImage)\" v-for=\"image in course.courseImages\" :key=\"image.id\"\r\n                class=\"w-24 h-24 rounded-xl object-cover hover:opacity-70 border shadow-sm\" :src=\"image.urlImage\"\r\n                alt=\"\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"w-1/3 bg-white shadow-md border border-gray-200 rounded-lg p-5\">\r\n            <div v-if=\"!isRegistered\" class=\"w-full flex justify-between \">\r\n              <h3 class=\"line-through text-gray-400 font-semibold\">{{ formatPrice(course.price - (course.price *\r\n                (course.reduce / 100))) }}đ</h3>\r\n              <p class=\"bg-red-800 py-1 rounded-lg px-2 text-white text-sm text-center\">\r\n                Giảm giá {{ course.reduce }}%\r\n              </p>\r\n            </div>\r\n            <h1 v-if=\"!isRegistered\" class=\"font-semibold text-xl text-red-600\">\r\n              {{ formatPrice(course.price) }}đ\r\n            </h1>\r\n\r\n            <div action=\"\" class=\"flex flex-col gap-5 mt-5\">\r\n              <div class=\"flex flex-col gap-3 text-sm\">\r\n                <p>Xin chào: <span class=\"font-semibold\">Nguyễn Quốc Anh</span></p>\r\n                <p>Cảm ơn bạn đã quan tâm khóa học này!</p>\r\n                <p>Cam kết đảm bảo chất lượng đầu ra khi bạn hoàn thành khóa học.</p>\r\n                <p v-if=\"!isRegistered\">Nhấn vào nút <span class=\"font-semibold\">\"ĐĂNG KÝ\"</span> để đăng ký khóa học</p>\r\n                <p v-else>Để theo dõi khóa học nhấn vào nút <span class=\"font-semibold\">\"THEO DÕI\"</span> để tham giá khóa\r\n                  học </p>\r\n              </div>\r\n              <a v-if=\"!isRegistered\" :href=\"'/payment/' + course.id\"\r\n                class=\"bg-slate-700 text-white text-center text-sm font-medium rounded-lg py-3  cursor-pointer hover:opacity-70\">\r\n                ĐĂNG KÝ\r\n              </a>\r\n              <a v-else href=\"/my-course\"\r\n                class=\"bg-slate-700 text-white text-center text-sm rounded-lg py-3 font-medium cursor-pointer hover:opacity-70\">\r\n                THEO DÕI\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"flex gap-10 w-full bg-white rounded-lg p-5 shadow-md\">\r\n      <div class=\"w-2/3\">\r\n        <p class=\"text-sm leading-7 text-slate-600\">{{ course.description }}</p>\r\n      </div>\r\n      <div class=\"1/3 mx-auto\">\r\n        <img class=\"rounded-full w-full h-36 object-cover\"\r\n          src=\"https://static.kt.city/e0ebee87-aefb-40bf-96a3-9a53986dfc17.jpg\" alt=\"\" />\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"bg-white rounded-lg p-5 mt-5 shadow-md\">\r\n      <h1 class=\"font-semibold text-xl\">\r\n        <i class=\"fa-solid fa-book pr-2\"></i>NỘI DUNG BÀI HỌC\r\n      </h1>\r\n\r\n      <div class=\"mt-3 flex flex-col gap-5\">\r\n        <div v-for=\"thematic in course.thematicCourses\" :key=\"thematic.id\">\r\n          <h1 class=\"bg-slate-600 text-white py-2 px-2\">{{ thematic.name }}</h1>\r\n\r\n          <div v-for=\"video in thematic.videoCourses\" :key=\"video.id\" class=\"flex justify-between mt-4 mx-4\">\r\n            <p class=\"text-gray-600\">\r\n              <i class=\"fa-regular fa-circle-play pr-2\"></i>{{ video.name }}\r\n            </p>\r\n            <p class=\"text-gray-600\">{{ video.duration }}</p>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div>\r\n      <div class=\"bg-white rounded-lg p-5 mt-5 shadow-md\">\r\n        <h1 class=\"font-semibold text-xl\">\r\n          <i class=\"fa-regular fa-comments pr-2\"></i>ĐÁNH GIÁ KHÓA HỌC\r\n        </h1>\r\n\r\n        <form class=\"mt-3\" @submit.prevent=\"submitFormEvaluation\">\r\n          <div class=\"w-full flex gap-3\">\r\n\r\n            <input v-model=\"formData.comment\" name=\"evaluation\" required type=\"text\"\r\n              class=\"border-b-slate-200 border-b px-2 bg-transparent w-full outline-none\"\r\n              placeholder=\"Đánh giá khóa học...\" />\r\n\r\n            <input v-model=\"formData.rate\" :id=\"course.id\" ref=\"evaluationInput\" required type=\"number\" min=\"1\" max=\"10\"\r\n              class=\"border-b-slate-200 border-b px-2 bg-transparent w-full outline-none\" placeholder=\"Điểm: 1/10\" />\r\n            <input type=\"submit\" value=\"Bình luận\"\r\n              class=\"hover:opacity-70 cursor-pointer bg-slate-700 text-white rounded-lg px-3 py-2 text-sm\" />\r\n          </div>\r\n        </form>\r\n\r\n        <div class=\"flex flex-col gap-5 mt-5\">\r\n          <div class=\"flex gap-3 border-b-slate-200 border-b w-full pb-3 last:border-b-0\"\r\n            v-for=\"(evaluation) in displayedEvaluations\" :key=\"evaluation.id\">\r\n            <div>\r\n              <img class=\"w-10 h-10 rounded-full object-cover\"\r\n                src=\"https://musicart.xboxlive.com/7/4d4d6500-0000-0000-0000-000000000002/504/image.jpg?w=1920&h=1080\"\r\n                alt=\"\" />\r\n            </div>\r\n\r\n            <div class=\"flex flex-col gap-1\">\r\n              <p class=\"font-semibold text-sm\">Nguyễn quốc anh</p>\r\n              <p class=\"text-sm text-gray-400 text-sm\">\r\n                <i class=\"fa-regular fa-clock pr-2\"></i>{{ evaluation.createdAt }}\r\n              </p>\r\n              <p class=\"bg-transparent w-full outline-none text-sm text-slate-600\">\r\n                {{ evaluation.comment }}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <button @click=\"changeShowEvaluate\" v-if='!showMoreEvaluate && course.courseEvaluations.length > 5'\r\n            class=\"bg-slate-700 text-white w-28 py-2 rounded-lg mx-auto hover:opacity-70\">Xem thêm</button>\r\n          <button @click=\"changeShowEvaluate\" v-if='showMoreEvaluate && course.courseEvaluations.length > 5'\r\n            class=\"bg-slate-700 text-white w-28 py-2 rounded-lg mx-auto hover:opacity-70\">Thu gọn</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <p v-else>Loading...</p>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport { ref } from \"vue\";\r\nimport { useRoute } from 'vue-router';\r\nimport { findApiByName } from \"../../../assets/js/apiUtil.js\";\r\n\r\n\r\nexport default {\r\n  mounted() {\r\n    const isRegistered = async () => {\r\n      try {\r\n        //get url API\r\n        const apiObject = findApiByName(\"order\", \"course\").url;\r\n        const res = await axios.get(apiObject, {\r\n          params: {\r\n            courseID: parseInt(this.$route.params.id),\r\n            userID: parseInt(localStorage.getItem(\"idUser\")),\r\n          },\r\n        });\r\n\r\n        this.isRegistered = res.data;\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n\r\n    isRegistered();\r\n  },\r\n  setup() {\r\n    const course = ref();\r\n    const route = useRoute();\r\n    const courseId = route.params.id;\r\n\r\n    const getCourse = async () => {\r\n      try {\r\n        const res = await axios.get(\"http://localhost:8087/api/course/\" + courseId);\r\n\r\n        course.value = res.data.data;\r\n\r\n        if (course.value.courseImages.length > 0) {\r\n          course.value.urlImage = course.value.courseImages[0].urlImage;\r\n        }\r\n\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    }\r\n\r\n    getCourse();\r\n\r\n    return {\r\n      getCourse,\r\n      course\r\n    }\r\n  },\r\n  methods: {\r\n    formatPrice(price) {\r\n      return price.toLocaleString(\"vi-VN\");\r\n    },\r\n\r\n    //insert evaluation\r\n    async insertEvaluation() {\r\n      try {\r\n        const res = await axios.post(\"http://localhost:8087/api/evaluation\", this.formData);\r\n\r\n        if (res.status == 200) {\r\n          this.getCourse();\r\n        }\r\n\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n\r\n\r\n    //submit form evaluation\r\n    submitFormEvaluation() {\r\n      const inputElement = this.$refs.evaluationInput;\r\n      if (inputElement) {\r\n        this.formData.courseID = inputElement.id;\r\n\r\n        this.insertEvaluation();\r\n      }\r\n    },\r\n\r\n    //change more or less evaluate\r\n    changeShowEvaluate() {\r\n      this.showMoreEvaluate = !this.showMoreEvaluate;\r\n\r\n      if (this.showMoreEvaluate == false) {\r\n        this.itemsPerPage = 5;\r\n      }\r\n      else {\r\n        this.itemsPerPage = this.course.courseEvaluations.length;\r\n      }\r\n    },\r\n\r\n    //click subImage in page detail change main Image\r\n    changeImage(newImageUrl) {\r\n      this.course.urlImage = newImageUrl;\r\n    },\r\n  },\r\n  computed: {\r\n    displayedEvaluations() {\r\n      const start = (this.currentPage - 1) * this.itemsPerPage;\r\n      const end = start + this.itemsPerPage;\r\n      return this.course.courseEvaluations.slice(start, end);\r\n    },\r\n    pages() {\r\n      return Math.ceil(this.course.courseEvaluations.length / this.itemsPerPage);\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      isRegistered: true,\r\n      formData: {\r\n        courseID: this.$route.params.id,\r\n        comment: '',\r\n        rate: 1,\r\n        userID: localStorage.getItem('idUser') != null ? localStorage.getItem('idUser') : null,\r\n      },\r\n      showMoreEvaluate: false,\r\n      currentPage: 1,\r\n      itemsPerPage: 5\r\n    };\r\n  },\r\n  watch: {},\r\n  name: \"DetailCourse\",\r\n  components: {},\r\n};\r\n</script>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}